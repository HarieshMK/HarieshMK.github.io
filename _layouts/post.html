---
layout: default
---

<div class="progress-container">
  <div class="progress-bar-track">
    <div class="progress-bar" id="myBar"></div>
  </div>
</div>

<article class="post-content">
  <header class="post-header">
    <h1>{{ page.title }}</h1>
    <div class="post-meta">
      <time>{{ page.date | date: "%B %d, %Y" }}</time>
      <span class="separator">•</span>
      <span class="reading-time">
        {% assign words = content | number_of_words %}
        {{ words | divided_by: 180 | plus: 1 }} min read
      </span>
    </div>
  </header>

  <div class="entry-content">
    {{ content }}
  </div>
</article>

<section class="subscribe-box">
   <div class="ml-embedded" data-form="TsxbQJ"></div>
</section>

<section class="comments">
  <h3>Discussion</h3>
  <p style="font-size: 0.85rem; color: #666; margin-bottom: 20px;">
    Have a thought or a question? Share it below. (No account required)
  </p>
  
  <div id="cusdis_thread"
    data-host="https://cusdis.com"
    data-app-id="078e37ac-a7c4-4015-a9ec-e3e1aa8ca3f0"
    data-page-id="{{ page.url }}"
    data-page-url="{{ site.url }}{{ page.url }}"
    data-page-title="{{ page.title }}">
  </div>
  
  <script async defer src="https://cusdis.com/js/cusdis.es.js"></script>
</section>

<div class="post-footer">
  <div class="post-nav">
    <div class="nav-prev">
      {% if page.previous %}
        <a href="{{ page.previous.url | relative_url }}" class="nav-link">
          <span class="nav-label">← Previous</span>
          <span class="nav-title">{{ page.previous.title }}</span>
        </a>
      {% endif %}
    </div>

    <div class="nav-next">
      {% if page.next %}
        <a href="{{ page.next.url | relative_url }}" class="nav-link">
          <span class="nav-label">Next →</span>
          <span class="nav-title">{{ page.next.title }}</span>
        </a>
      {% endif %}
    </div>
  </div>

  <div class="back-to-blogs-container">
    <a href="{{ '/blogs/' | relative_url }}" class="back-link">View All Writing</a>
  </div>
</div>

<script>
window.onscroll = function() {
  // FIXED: Changed '.container' to '.entry-content' to match your HTML above
  var article = document.querySelector('.entry-content'); 
  var bar = document.querySelector('.progress-bar');
  var container = document.querySelector('.progress-container');

  if (article && bar) {
    var articleTop = article.offsetTop;
    var articleHeight = article.offsetHeight;
    var windowHeight = window.innerHeight;
    var scrollTop = window.pageYOffset || document.documentElement.scrollTop;

    // Show bar when user reaches the content, hide it at the header/footer
    // We use 100px as a buffer so it appears right as they start reading
    if (scrollTop > (articleTop - 100)) {
        container.style.opacity = "1";
    } else {
        container.style.opacity = "0";
    }

    // Accurate math: Progress = (Distance Scrolled / Total Scrollable Area of Article)
    var scrolled = ((scrollTop - articleTop) / (articleHeight - windowHeight)) * 100;
    
    // Safety check: Keep it between 0% and 100%
    bar.style.width = Math.min(Math.max(scrolled, 0), 100) + "%";
  }
}

// 2. DARK MODE GLITCH FIX
window.addEventListener('load', function() {
  const isDark = document.body.classList.contains('dark-theme');
  if (window.CUSDIS) {
    window.CUSDIS.setTheme(isDark ? 'dark' : 'light');
  }
});
</script>
